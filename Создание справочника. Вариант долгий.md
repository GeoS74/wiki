1. скачать [[КЛАДР|БД КЛАДР]], в архиве несколько файлов .DBF
2. с помощью [[КЛАДР|КЛАДР-браузера]] открыть БД
3. перевести файл KLADR.DBF в формат .csv
4. в файле .csv на новой вкладке заполнить вручную регионы и города, которые не помечены серым цветом (цветом помечаются устаревшие данные).
    Должно получиться примерно 637 строчек. Проблема здесь в том, что не все города будут на верхнем уровне, т.к. некоторые (напр. Аша) находятся внутри иерархии (напр. в Ашинском -не)
5. на основной вкаладке .csv перевести коды КЛАДР в нормальный вид, иначе они отображаются примерно так 2,001Е+11
    также следует обратить внимание на то, что коды, начинающиеся на "0" теряют этот ноль.
    Формула для нормализации кода КЛАДР населенного пункта
	```
	=ЕСЛИ( ДЛСТР(C725)=12; "`0"&C725;"`"&C725)
	```
	на выходе: \`0200100000000
6. нормализовать код региона. Формула использует значение, полученное при нормализации кода для населенного пункта:
	```
	=ЛЕВСИМВ(J725;3)&"00000000000"
	```
	на выходе: \`0200000000000
7. найти строчки, которые уже попали в основной список городов. Формула:
	```
    =ВПР(J725;Лист1!$F$2:$F$638;1;0)
	```
    на выходе: \#Н/Д - если код не попал в список, код - если он там уже есть
8. привести значение, полученное в п.п.7 к 0 (код отсутствует) или 1 (код уже есть)
    Формула:
	```
    =ЕСЛИ(ЕСНД(K725;1)=1;0;1)
	```
    на выходе: 0 (код отсутствует) или 1 (код уже есть)
9. установить признак необходимости добавления города в основной список. Для этого используется условие: если код ещё не в основном списке и населенный пункт это город.
    Формула:
	```
    =ЕСЛИ(И(L725=0;B725="г");1;0)
	```
    на выходе: 1 - если надо добавить город в основной список, 0 - если нет
    здесь могут возникнуть дубликаты, например Уфа, в БД через КЛАДР-браузер е неё код 0200000100000, в .csv выгруженном из БД будет 2-е Уфы (хз почему так)
10. проверить на дубликаты. Взять название из колонки NAME и сравнить с наименованием в новом списке.
    Формула:
	```
    =ВПР(A1486;Лист1!$D$2:$D$638;1;0)
	```
    на выходе: \#Н/Д - если это не дубликат, либо название города - если это дубликат
11. отфильтровать, оставив те, которых нет в новом списке и убрать дубликаты

